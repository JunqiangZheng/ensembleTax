<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="D Catlett" />


<title>ensembleTax package Vignette</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css" data-origin="pandoc">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */

</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    for (var j = 0; j < rules.length; j++) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") continue;
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') continue;
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />




</head>

<body>




<h1 class="title toc-ignore">ensembleTax package Vignette</h1>
<h4 class="author">D Catlett</h4>
<h4 class="date">8/17/2020</h4>



<div id="ensembletax-overview" class="section level1">
<h1>ensembleTax overview</h1>
<p>ensembleTax is an R package that allows incorporation of information from multiple taxonomic assignment algorithms and/or reference databases to compute ensemble taxonomic assignments for ASVs/OTUs generated by common marker gene sequence analyses.</p>
<p>Please note that this is a simple vignette to demonstrate the functionality of the package. See XXXXXXXXXXXXXXXXXXXXXX for more detailed discussion and example uses.</p>
<div id="the-problem" class="section level2">
<h2>The problem</h2>
<p>Taxonomic assignment of marker gene sequences is a critical step of marker gene workflows as it imparts ecological significance and understanding to genetic data.</p>
<p>Many taxonomic assignment algorithms have been proposed to assign taxonomy to marker gene sequences (or OTUs/ASVs). Similarly, analysts are often forced to choose from one of several reference databases containing representative marker gene sequences with known taxonomic identities. The “best” assignment algorithm and/or reference database for a particular scientific question is often not obvious. To complicate things further, different reference databases generally do not share consistent taxonomic naming or ranking conventions.</p>
<p>ensembleTax solves this problem by providing flexible algorithms that synthesize information from multiple taxonomic assignment algorithm/reference database combinations and compute a single ensemble taxonomic assignment for each ASV/OTU in a marker gene data set.</p>
</div>
<div id="ensembletax-algorithms" class="section level2">
<h2>ensembleTax algorithms</h2>
<p>The core algorithms employed by ensembleTax are <em>taxmapper</em> and <em>ensembleTax</em>. <em>taxmapper</em> maps, or ‘translates’, one taxonomic nomenclature onto another by exact name matching. <em>taxmapper</em> is rank-agnostic, meaning it does not consider the hierarchical structure of a taxonomy and assumes that a taxonomic name means the same thing regardless of which reference database employs it.</p>
<p><em>ensembleTax</em> computes ensemble taxonomic assignments based on assignments determined by any number of individual taxonomic assignment algorithm/reference database combinations. Several parameters allow the user to control trade-offs in the accuracy vs. resolution of taxonomic assignments.</p>
<p>Additional functions are included for pre-processing taxonomic assignments generated by specific taxonomic assignment algorithms and reference databases. These functions are designed to conveniently plug in downstream of the dada2 pipeline, but other pipelines may be used if the data is formatted properly for use with <em>taxmapper</em> and/or <em>ensembleTax</em>.</p>
<p>The taxonomic assignment algorithms explicitly supported by ensembleTax are:</p>
<ol style="list-style-type: decimal">
<li>bayesian classifier as implemented in dada2’s assignTaxonomy.</li>
<li>idtaxa algorithm as implemented in DECIPHER.</li>
<li>Lowest Common Ancestor algorithm implemented in MEGAN6.</li>
</ol>
<p>Supported reference databases include:</p>
<ol style="list-style-type: decimal">
<li>Silva SSU NR reference database (silva).</li>
<li>Protistan Ribosomal Reference database (pr2).</li>
</ol>
<p>Note that other databases may still be used with ensembleTax, but they must be mapped onto the taxonomic nomenclatures employed by Silva and/or pr2 using <em>taxmapper</em>.</p>
<div id="ensembletax-pipeline-demonstration" class="section level3">
<h3>ensembleTax ‘pipeline’ demonstration</h3>
<p>Here we step through a simple example of an ensembleTax workflow to compute ensemble taxonomic assignments for a small set of 18S-V9 protist ASVs.</p>
<p>First, load some data included with the ensembleTax package. These are outputs of dada2’s assignTaxonomy implemented against pr2, and of DECIPHER’s idtaxa implemented against both pr2 and silva. The rubric.sample is an example of a “rubric”, which ensembleTax uses to track ASV-identifying information. The rubric is a DNAStringSet (see the Biostrings package) object produced by extracting ASV sequences from the seqtab used by dada2, and giving them arbitrary names (like sv1, sv2, etc).</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(<span class="st">&quot;ensembleTax&quot;</span>)

<span class="kw">data</span>(<span class="st">&quot;idtax.pr2.sample&quot;</span>)
<span class="kw">data</span>(<span class="st">&quot;idtax.silva.sample&quot;</span>)
<span class="kw">data</span>(<span class="st">&quot;bayes.sample&quot;</span>)
<span class="kw">data</span>(<span class="st">&quot;rubric.sample&quot;</span>)

<span class="kw">head</span>(idtax.pr2.sample)</code></pre></div>
<pre><code>## [[1]]
## [[1]]$taxon
## [1] &quot;Root&quot;                       &quot;Eukaryota&quot;                 
## [3] &quot;Stramenopiles&quot;              &quot;Ochrophyta&quot;                
## [5] &quot;Bacillariophyta&quot;            &quot;Bacillariophyta_X&quot;         
## [7] &quot;Polar-centric-Mediophyceae&quot; &quot;Chaetoceros&quot;               
## [9] &quot;Chaetoceros_debilis_2&quot;     
## 
## [[1]]$confidence
## [1] 82.20536 82.20536 81.01873 81.01873 81.01873 81.01873 81.01873 81.01873
## [9] 30.03599
## 
## 
## [[2]]
## [[2]]$taxon
## [1] &quot;Root&quot;                       &quot;Eukaryota&quot;                 
## [3] &quot;Stramenopiles&quot;              &quot;Ochrophyta&quot;                
## [5] &quot;Bacillariophyta&quot;            &quot;Bacillariophyta_X&quot;         
## [7] &quot;Polar-centric-Mediophyceae&quot; &quot;Thalassiosira&quot;             
## [9] &quot;Thalassiosira_hispida&quot;     
## 
## [[2]]$confidence
## [1] 71.33810 71.33810 66.29660 64.95401 64.95401 64.95401 59.40574 19.26610
## [9] 16.38823
## 
## 
## [[3]]
## [[3]]$taxon
## [1] &quot;Root&quot;           &quot;Eukaryota&quot;      &quot;Stramenopiles&quot;  &quot;Ochrophyta&quot;    
## [5] &quot;MOCH-2&quot;         &quot;MOCH-2_X&quot;       &quot;MOCH-2_XX&quot;      &quot;MOCH-2_XXX&quot;    
## [9] &quot;MOCH-2_XXX_sp.&quot;
## 
## [[3]]$confidence
## [1] 67.78686 67.78686 61.88273 58.94742 49.33213 49.33213 49.33213 49.33213
## [9] 49.33213
## 
## 
## [[4]]
## [[4]]$taxon
## [1] &quot;Root&quot;             &quot;Eukaryota&quot;        &quot;Archaeplastida&quot;   &quot;Streptophyta&quot;    
## [5] &quot;Embryophyceae&quot;    &quot;Embryophyceae_X&quot;  &quot;Embryophyceae_XX&quot; &quot;Taxus&quot;           
## [9] &quot;Taxus_baccata&quot;   
## 
## [[4]]$confidence
## [1] 45.398229 45.398229 18.583773 18.157256 12.643442 12.643442 12.643442
## [8]  8.117989  8.117989
## 
## 
## [[5]]
## [[5]]$taxon
## [1] &quot;Root&quot;           &quot;Eukaryota&quot;      &quot;Stramenopiles&quot;  &quot;Opalozoa&quot;      
## [5] &quot;MAST-3&quot;         &quot;MAST-3B&quot;        &quot;MAST-3B_X&quot;      &quot;MAST-3B_XX&quot;    
## [9] &quot;MAST-3B_XX_sp.&quot;
## 
## [[5]]$confidence
## [1] 92.47240 92.47240 90.81644 47.09622 46.51236 45.64512 45.64512 45.64512
## [9] 45.64512</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(idtax.silva.sample)</code></pre></div>
<pre><code>## [[1]]
## [[1]]$taxon
## [1] &quot;Root&quot;              &quot;Eukaryota&quot;         &quot;SAR&quot;              
## [4] &quot;Stramenopiles&quot;     &quot;Ochrophyta&quot;        &quot;Diatomea&quot;         
## [7] &quot;Bacillariophytina&quot; &quot;Mediophyceae&quot;      &quot;Chaetoceros&quot;      
## 
## [[1]]$confidence
## [1] 60.26929 55.47228 50.50453 48.89802 47.20018 46.61874 46.15582 45.57871
## [9] 43.57134
## 
## [[1]]$rank
## [1] &quot;rootrank&quot;    &quot;domain&quot;      &quot;major_clade&quot; &quot;kingdom&quot;     &quot;superphylum&quot;
## [6] &quot;phylum&quot;      &quot;subphylum&quot;   &quot;class&quot;       &quot;genus&quot;      
## 
## 
## [[2]]
## [[2]]$taxon
## [1] &quot;Root&quot;              &quot;Eukaryota&quot;         &quot;SAR&quot;              
## [4] &quot;Stramenopiles&quot;     &quot;Ochrophyta&quot;        &quot;Diatomea&quot;         
## [7] &quot;Bacillariophytina&quot; &quot;Mediophyceae&quot;      &quot;Thalassiosira&quot;    
## 
## [[2]]$confidence
## [1] 64.40876 62.34590 55.16122 48.52020 48.52020 48.52020 45.61851 38.14735
## [9] 27.39857
## 
## [[2]]$rank
## [1] &quot;rootrank&quot;    &quot;domain&quot;      &quot;major_clade&quot; &quot;kingdom&quot;     &quot;superphylum&quot;
## [6] &quot;phylum&quot;      &quot;subphylum&quot;   &quot;class&quot;       &quot;genus&quot;      
## 
## 
## [[3]]
## [[3]]$taxon
## [1] &quot;Root&quot;          &quot;Eukaryota&quot;     &quot;SAR&quot;           &quot;Stramenopiles&quot;
## [5] &quot;Ochrophyta&quot;    &quot;MOCH-2&quot;       
## 
## [[3]]$confidence
## [1] 70.91750 67.31802 64.52419 63.72148 62.63950 61.55201
## 
## [[3]]$rank
## [1] &quot;rootrank&quot;    &quot;domain&quot;      &quot;major_clade&quot; &quot;kingdom&quot;     &quot;superphylum&quot;
## [6] &quot;class&quot;      
## 
## 
## [[4]]
## [[4]]$taxon
##  [1] &quot;Root&quot;               &quot;Eukaryota&quot;          &quot;Archaeplastida&quot;    
##  [4] &quot;Chloroplastida&quot;     &quot;Charophyta&quot;         &quot;Phragmoplastophyta&quot;
##  [7] &quot;Streptophyta&quot;       &quot;Embryophyta&quot;        &quot;Tracheophyta&quot;      
## [10] &quot;Spermatophyta&quot;      &quot;Pinophyta&quot;         
## 
## [[4]]$confidence
##  [1] 55.95076 50.88138 37.40822 37.40822 37.40822 37.40822 37.40822 31.93052
##  [9] 31.93052 31.15123 29.84479
## 
## [[4]]$rank
##  [1] &quot;rootrank&quot;    &quot;domain&quot;      &quot;major_clade&quot; &quot;kingdom&quot;     &quot;subkingdom&quot; 
##  [6] &quot;phylum&quot;      &quot;subphylum&quot;   &quot;class&quot;       &quot;subclass&quot;    &quot;infraclass&quot; 
## [11] &quot;superorder&quot; 
## 
## 
## [[5]]
## [[5]]$taxon
## [1] &quot;Root&quot;          &quot;Eukaryota&quot;     &quot;SAR&quot;           &quot;Stramenopiles&quot;
## [5] &quot;MAST-3&quot;        &quot;MAST-3B&quot;      
## 
## [[5]]$confidence
## [1] 92.92780 92.36003 91.05291 91.05291 91.05291 88.60307
## 
## [[5]]$rank
## [1] &quot;rootrank&quot;    &quot;domain&quot;      &quot;major_clade&quot; &quot;kingdom&quot;     &quot;phylum&quot;     
## [6] &quot;class&quot;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(bayes.sample)</code></pre></div>
<pre><code>## $tax
##                                                                                                                                    Kingdom    
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC &quot;Eukaryota&quot;
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC       &quot;Eukaryota&quot;
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC     &quot;Eukaryota&quot;
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC    &quot;Eukaryota&quot;
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT      &quot;Eukaryota&quot;
##                                                                                                                                    Supergroup      
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC &quot;Archaeplastida&quot;
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC       &quot;Stramenopiles&quot; 
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC     &quot;Stramenopiles&quot; 
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC    &quot;Stramenopiles&quot; 
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT      &quot;Stramenopiles&quot; 
##                                                                                                                                    Division      
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC &quot;Streptophyta&quot;
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC       &quot;Opalozoa&quot;    
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC     &quot;Ochrophyta&quot;  
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC    &quot;Ochrophyta&quot;  
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT      &quot;Ochrophyta&quot;  
##                                                                                                                                    Class            
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC &quot;Embryophyceae&quot;  
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC       &quot;MAST-3&quot;         
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC     &quot;Bacillariophyta&quot;
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC    &quot;MOCH-2&quot;         
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT      &quot;Bacillariophyta&quot;
##                                                                                                                                    Order              
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC &quot;Embryophyceae_X&quot;  
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC       &quot;MAST-3B&quot;          
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC     &quot;Bacillariophyta_X&quot;
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC    &quot;MOCH-2_X&quot;         
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT      &quot;Bacillariophyta_X&quot;
##                                                                                                                                    Family                      
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC &quot;Embryophyceae_XX&quot;          
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC       &quot;MAST-3B_X&quot;                 
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC     &quot;Polar-centric-Mediophyceae&quot;
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC    &quot;MOCH-2_XX&quot;                 
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT      &quot;Polar-centric-Mediophyceae&quot;
##                                                                                                                                    Genus        
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC &quot;Pinus&quot;      
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC       &quot;MAST-3B_XX&quot; 
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC     &quot;Minidiscus&quot; 
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC    &quot;MOCH-2_XXX&quot; 
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT      &quot;Chaetoceros&quot;
##                                                                                                                                    Species                
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC &quot;Pinus_wallichiana&quot;    
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC       &quot;MAST-3B_XX_sp.&quot;       
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC     &quot;Minidiscus_sp.&quot;       
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC    &quot;MOCH-2_XXX_sp.&quot;       
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT      &quot;Chaetoceros_debilis_2&quot;
## 
## $boot
##                                                                                                                                    Kingdom
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC     100
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC           100
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC         100
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC        100
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT          100
##                                                                                                                                    Supergroup
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC         79
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC               97
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC             93
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC            66
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT              99
##                                                                                                                                    Division
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC       74
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC             95
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC           93
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC          65
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT            99
##                                                                                                                                    Class
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC    59
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC          93
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC        93
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC       58
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT         98
##                                                                                                                                    Order
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC    59
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC          93
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC        93
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC       58
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT         98
##                                                                                                                                    Family
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC     59
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC           93
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC         86
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC        58
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT          98
##                                                                                                                                    Genus
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC    37
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC          93
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC        59
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC       58
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT         97
##                                                                                                                                    Species
## ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC      22
## GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC            93
## ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC          59
## GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC         58
## GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT           48</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(rubric.sample)</code></pre></div>
<pre><code>## Loading required package: Biostrings</code></pre>
<pre><code>## Loading required package: BiocGenerics</code></pre>
<pre><code>## Loading required package: parallel</code></pre>
<pre><code>## 
## Attaching package: 'BiocGenerics'</code></pre>
<pre><code>## The following objects are masked from 'package:parallel':
## 
##     clusterApply, clusterApplyLB, clusterCall, clusterEvalQ,
##     clusterExport, clusterMap, parApply, parCapply, parLapply,
##     parLapplyLB, parRapply, parSapply, parSapplyLB</code></pre>
<pre><code>## The following objects are masked from 'package:stats':
## 
##     IQR, mad, sd, var, xtabs</code></pre>
<pre><code>## The following objects are masked from 'package:base':
## 
##     anyDuplicated, append, as.data.frame, basename, cbind, colnames,
##     dirname, do.call, duplicated, eval, evalq, Filter, Find, get, grep,
##     grepl, intersect, is.unsorted, lapply, Map, mapply, match, mget,
##     order, paste, pmax, pmax.int, pmin, pmin.int, Position, rank,
##     rbind, Reduce, rownames, sapply, setdiff, sort, table, tapply,
##     union, unique, unsplit, which, which.max, which.min</code></pre>
<pre><code>## Loading required package: S4Vectors</code></pre>
<pre><code>## Loading required package: stats4</code></pre>
<pre><code>## 
## Attaching package: 'S4Vectors'</code></pre>
<pre><code>## The following object is masked from 'package:base':
## 
##     expand.grid</code></pre>
<pre><code>## Loading required package: IRanges</code></pre>
<pre><code>## Loading required package: XVector</code></pre>
<pre><code>## 
## Attaching package: 'Biostrings'</code></pre>
<pre><code>## The following object is masked from 'package:base':
## 
##     strsplit</code></pre>
<pre><code>##   A DNAStringSet instance of length 5
##     width seq                                               names               
## [1]   125 GCACCCACCGATTGAAAAGCCCG...GGTGAAGTCGTAACAAGGTCTCT sv20747
## [2]   126 ACACCTACCAATTGAATGGTCCG...GGTGAAGTTGTAACAAGGTTTCC sv14136
## [3]   127 GCACCTACCGATTGAACCATACG...GGTGAAGTCGTAACAAGGTTTCC sv17278
## [4]   130 ACTCCTACCAATTGAATGATCCA...GGAGAAGTCATAACAAGGTTACC sv3579
## [5]   124 GCACCTACCGATTGAATGGTCCG...GGTGAAGTCGTAACAAGGTTTCC sv4298</code></pre>
<div id="ensembletax-pre-processing" class="section level4">
<h4>ensembleTax pre-processing</h4>
<p>We see from the above that the data structures returned by our two taxonomic assignment algorithms are different. It is critically important that the order of sequences in the rubric and in the idtaxa-returned Taxon object are the same. idtaxa does not return sequence names, but if you did not alter the order of your sequences as you provided them to idtaxa and/or DNAStringSet when creating your rubric, the ordering should be preserved and you should be good to go.</p>
<p>Here we’ll run these tables through ensembleTax’s pre-processing functions. Supplying a rubric allows ensembleTax to give each taxonomy table the same ASV- identifying information and to better track and organize your data.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">idtax.pr2.pretty &lt;-<span class="st"> </span><span class="kw">idtax2df</span>(idtax.pr2.sample, 
                             <span class="dt">db =</span> <span class="st">&quot;pr2&quot;</span>, 
                             <span class="dt">ranks =</span> <span class="ot">NULL</span>,
                             <span class="dt">boot =</span> <span class="dv">50</span>,
                             <span class="dt">rubric =</span> rubric.sample,
                             <span class="dt">return.conf =</span> <span class="ot">FALSE</span>)
idtax.silva.pretty &lt;-<span class="st"> </span><span class="kw">idtax2df</span>(idtax.silva.sample, 
                             <span class="dt">db =</span> <span class="st">&quot;silva&quot;</span>, 
                             <span class="dt">ranks =</span> <span class="ot">NULL</span>,
                             <span class="dt">boot =</span> <span class="dv">50</span>,
                             <span class="dt">rubric =</span> rubric.sample,
                             <span class="dt">return.conf =</span> <span class="ot">FALSE</span>)
bayes.pr2.pretty &lt;-<span class="st"> </span><span class="kw">bayestax2df</span>(bayes.sample, 
                             <span class="dt">db =</span> <span class="st">&quot;pr2&quot;</span>, 
                             <span class="dt">ranks =</span> <span class="ot">NULL</span>,
                             <span class="dt">boot =</span> <span class="dv">50</span>,
                             <span class="dt">rubric =</span> rubric.sample,
                             <span class="dt">return.conf =</span> <span class="ot">FALSE</span>)

<span class="kw">head</span>(idtax.pr2.pretty)</code></pre></div>
<pre><code>##       svN
## 1 sv14136
## 2 sv17278
## 3 sv20747
## 4  sv3579
## 5  sv4298
##                                                                                                                                  ASV
## 1     ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC
## 2    GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
## 3      GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT
## 4 ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC
## 5       GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
##     kingdom    supergroup   division           class             order
## 1 Eukaryota Stramenopiles Ochrophyta Bacillariophyta Bacillariophyta_X
## 2 Eukaryota Stramenopiles Ochrophyta            &lt;NA&gt;              &lt;NA&gt;
## 3 Eukaryota Stramenopiles Ochrophyta Bacillariophyta Bacillariophyta_X
## 4      &lt;NA&gt;          &lt;NA&gt;       &lt;NA&gt;            &lt;NA&gt;              &lt;NA&gt;
## 5 Eukaryota Stramenopiles       &lt;NA&gt;            &lt;NA&gt;              &lt;NA&gt;
##                       family       genus species
## 1 Polar-centric-Mediophyceae        &lt;NA&gt;    &lt;NA&gt;
## 2                       &lt;NA&gt;        &lt;NA&gt;    &lt;NA&gt;
## 3 Polar-centric-Mediophyceae Chaetoceros    &lt;NA&gt;
## 4                       &lt;NA&gt;        &lt;NA&gt;    &lt;NA&gt;
## 5                       &lt;NA&gt;        &lt;NA&gt;    &lt;NA&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(idtax.silva.pretty)</code></pre></div>
<pre><code>##       svN
## 1 sv14136
## 2 sv17278
## 3 sv20747
## 4  sv3579
## 5  sv4298
##                                                                                                                                  ASV
## 1     ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC
## 2    GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
## 3      GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT
## 4 ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC
## 5       GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
##      domain       phylum   class order family genus
## 1 Eukaryota         &lt;NA&gt;    &lt;NA&gt;  &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;
## 2 Eukaryota Eukaryota_ph  MOCH-2  &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;
## 3 Eukaryota         &lt;NA&gt;    &lt;NA&gt;  &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;
## 4 Eukaryota         &lt;NA&gt;    &lt;NA&gt;  &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;
## 5 Eukaryota       MAST-3 MAST-3B  &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(bayes.pr2.pretty)</code></pre></div>
<pre><code>##       svN
## 1 sv14136
## 2 sv17278
## 3 sv20747
## 4  sv3579
## 5  sv4298
##                                                                                                                                  ASV
## 1     ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC
## 2    GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
## 3      GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT
## 4 ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC
## 5       GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
##     kingdom     supergroup     division           class             order
## 1 Eukaryota  Stramenopiles   Ochrophyta Bacillariophyta Bacillariophyta_X
## 2 Eukaryota  Stramenopiles   Ochrophyta          MOCH-2          MOCH-2_X
## 3 Eukaryota  Stramenopiles   Ochrophyta Bacillariophyta Bacillariophyta_X
## 4 Eukaryota Archaeplastida Streptophyta   Embryophyceae   Embryophyceae_X
## 5 Eukaryota  Stramenopiles     Opalozoa          MAST-3           MAST-3B
##                       family       genus        species
## 1 Polar-centric-Mediophyceae  Minidiscus Minidiscus_sp.
## 2                  MOCH-2_XX  MOCH-2_XXX MOCH-2_XXX_sp.
## 3 Polar-centric-Mediophyceae Chaetoceros           &lt;NA&gt;
## 4           Embryophyceae_XX        &lt;NA&gt;           &lt;NA&gt;
## 5                  MAST-3B_X  MAST-3B_XX MAST-3B_XX_sp.</code></pre>
<p>We see that each taxonomy table is now a dataframe sorted by the column “svN”.</p>
</div>
<div id="the-taxmapper-algorithm" class="section level4">
<h4>The taxmapper algorithm</h4>
<p>After pre-processing our taxonomic assignment data sets above, we see we still can’t make apples-to-apples comparisons across between the “idtax-silva” table and the two others because they employ different ranking and (though this may not be as obvious) naming conventions. <em>taxmapper</em> was created to solve this problem.</p>
<p>Here we’ll use taxmapper to ‘translate’ the idtax-silva taxonomic assignments onto the same taxonomic nomenclature as the other two tables.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">idtax.silva.mapped2pr2 &lt;-<span class="st"> </span><span class="kw">taxmapper</span>(idtax.silva.pretty,
                      <span class="dt">tt.ranks =</span> <span class="kw">colnames</span>(idtax.silva.pretty)[<span class="dv">3</span>:<span class="kw">ncol</span>(idtax.silva.pretty)],
                      <span class="dt">tax2map2 =</span> <span class="st">&quot;pr2&quot;</span>,
                      <span class="dt">exceptions =</span> <span class="kw">c</span>(<span class="st">&quot;Archaea&quot;</span>, <span class="st">&quot;Bacteria&quot;</span>),
                      <span class="dt">ignore.format =</span> <span class="ot">TRUE</span>,
                      <span class="dt">synonym.file =</span> <span class="st">&quot;default&quot;</span>,
                      <span class="dt">streamline =</span> <span class="ot">TRUE</span>,
                      <span class="dt">outfilez =</span> <span class="ot">NULL</span>)
<span class="kw">head</span>(idtax.silva.mapped2pr2)</code></pre></div>
<pre><code>##       svN
## 1 sv14136
## 2 sv17278
## 3 sv20747
## 4  sv3579
## 5  sv4298
##                                                                                                                                  ASV
## 1     ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC
## 2    GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
## 3      GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT
## 4 ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC
## 5       GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
##     kingdom    supergroup   division  class   order family genus species
## 1 Eukaryota          &lt;NA&gt;       &lt;NA&gt;   &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;    &lt;NA&gt;
## 2 Eukaryota Stramenopiles Ochrophyta MOCH-2    &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;    &lt;NA&gt;
## 3 Eukaryota          &lt;NA&gt;       &lt;NA&gt;   &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;    &lt;NA&gt;
## 4 Eukaryota          &lt;NA&gt;       &lt;NA&gt;   &lt;NA&gt;    &lt;NA&gt;   &lt;NA&gt;  &lt;NA&gt;    &lt;NA&gt;
## 5 Eukaryota Stramenopiles   Opalozoa MAST-3 MAST-3B   &lt;NA&gt;  &lt;NA&gt;    &lt;NA&gt;</code></pre>
<p>Inspection of the mapped taxonomy table shows that it now mirrors the naming and ranking conventions of the other two taxonomy tables.</p>
</div>
<div id="the-ensembletax-algorithm" class="section level4">
<h4>The ensembleTax algorithm</h4>
<p>Now we have three different taxonomy tables with independent taxonomic assignments for each ASV in our example data set. From these we can compute ensemble taxonomic assignments with the <em>ensembleTax</em> algorithm.</p>
<p>We’ll do a few runs to show a range of outcomes that might be achieved by implementing the algorithm under different parameter spaces.</p>
<p>Here’s a run with the default parameters:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">xx &lt;-<span class="st"> </span><span class="kw">list</span>(idtax.pr2.pretty, idtax.silva.mapped2pr2, bayes.pr2.pretty)
<span class="kw">names</span>(xx) &lt;-<span class="st"> </span><span class="kw">c</span>(<span class="st">&quot;idtax-pr2&quot;</span>, <span class="st">&quot;idtax-silva&quot;</span>, <span class="st">&quot;bayes-pr2&quot;</span>)
eTax1 &lt;-<span class="st"> </span><span class="kw">ensembleTax</span>(xx, 
                     <span class="dt">tablenames =</span> <span class="kw">names</span>(xx), 
                     <span class="dt">ranknames =</span> <span class="kw">c</span>(<span class="st">&quot;kingdom&quot;</span>, <span class="st">&quot;supergroup&quot;</span>, <span class="st">&quot;division&quot;</span>,<span class="st">&quot;class&quot;</span>,<span class="st">&quot;order&quot;</span>,<span class="st">&quot;family&quot;</span>,<span class="st">&quot;genus&quot;</span>,<span class="st">&quot;species&quot;</span>),
                     <span class="dt">tiebreakz =</span> <span class="st">&quot;none&quot;</span>, 
                     <span class="dt">count.na=</span><span class="ot">TRUE</span>, 
                     <span class="dt">assign.threshold =</span> <span class="dv">0</span>, 
                     <span class="dt">weights=</span><span class="kw">rep</span>(<span class="dv">1</span>,<span class="kw">length</span>(xx)))</code></pre></div>
<pre><code>## no Frankenstein assignments detected</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(eTax1)</code></pre></div>
<pre><code>##       svN
## 1 sv14136
## 2 sv17278
## 3 sv20747
## 4  sv3579
## 5  sv4298
##                                                                                                                                  ASV
## 1     ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC
## 2    GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
## 3      GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT
## 4 ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC
## 5       GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
##     kingdom    supergroup   division           class             order
## 1 Eukaryota Stramenopiles Ochrophyta Bacillariophyta Bacillariophyta_X
## 2 Eukaryota Stramenopiles Ochrophyta          MOCH-2              &lt;NA&gt;
## 3 Eukaryota Stramenopiles Ochrophyta Bacillariophyta Bacillariophyta_X
## 4 Eukaryota          &lt;NA&gt;       &lt;NA&gt;            &lt;NA&gt;              &lt;NA&gt;
## 5 Eukaryota Stramenopiles   Opalozoa          MAST-3           MAST-3B
##                       family       genus species
## 1 Polar-centric-Mediophyceae        &lt;NA&gt;    &lt;NA&gt;
## 2                       &lt;NA&gt;        &lt;NA&gt;    &lt;NA&gt;
## 3 Polar-centric-Mediophyceae Chaetoceros    &lt;NA&gt;
## 4                       &lt;NA&gt;        &lt;NA&gt;    &lt;NA&gt;
## 5                       &lt;NA&gt;        &lt;NA&gt;    &lt;NA&gt;</code></pre>
<p>Just as an example of what is possible, we might tell <em>ensembleTax</em> not to count non-assignments (NA’s) by setting <em>count.na = FALSE</em>. Further, we might specify that the assignments in the idtax-pr2 table should be weighted double the other two (<em>weights = c(2,1,1)</em>) if we suspect that these are the most robust assignments for our ASV data set. Here’s what that looks like:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">eTax2 &lt;-<span class="st"> </span><span class="kw">ensembleTax</span>(xx, 
                     <span class="dt">tablenames =</span> <span class="kw">names</span>(xx), 
                     <span class="dt">ranknames =</span> <span class="kw">c</span>(<span class="st">&quot;kingdom&quot;</span>, <span class="st">&quot;supergroup&quot;</span>, <span class="st">&quot;division&quot;</span>,<span class="st">&quot;class&quot;</span>,<span class="st">&quot;order&quot;</span>,<span class="st">&quot;family&quot;</span>,<span class="st">&quot;genus&quot;</span>,<span class="st">&quot;species&quot;</span>),
                     <span class="dt">tiebreakz =</span> <span class="st">&quot;none&quot;</span>, 
                     <span class="dt">count.na=</span><span class="ot">FALSE</span>, 
                     <span class="dt">assign.threshold =</span> <span class="dv">0</span>, 
                     <span class="dt">weights=</span><span class="kw">c</span>(<span class="dv">2</span>,<span class="dv">1</span>,<span class="dv">1</span>))</code></pre></div>
<pre><code>## no Frankenstein assignments detected</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(eTax2)</code></pre></div>
<pre><code>##       svN
## 1 sv14136
## 2 sv17278
## 3 sv20747
## 4  sv3579
## 5  sv4298
##                                                                                                                                  ASV
## 1     ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC
## 2    GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
## 3      GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT
## 4 ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC
## 5       GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
##     kingdom     supergroup     division           class             order
## 1 Eukaryota  Stramenopiles   Ochrophyta Bacillariophyta Bacillariophyta_X
## 2 Eukaryota  Stramenopiles   Ochrophyta          MOCH-2          MOCH-2_X
## 3 Eukaryota  Stramenopiles   Ochrophyta Bacillariophyta Bacillariophyta_X
## 4 Eukaryota Archaeplastida Streptophyta   Embryophyceae   Embryophyceae_X
## 5 Eukaryota  Stramenopiles     Opalozoa          MAST-3           MAST-3B
##                       family       genus        species
## 1 Polar-centric-Mediophyceae  Minidiscus Minidiscus_sp.
## 2                  MOCH-2_XX  MOCH-2_XXX MOCH-2_XXX_sp.
## 3 Polar-centric-Mediophyceae Chaetoceros           &lt;NA&gt;
## 4           Embryophyceae_XX        &lt;NA&gt;           &lt;NA&gt;
## 5                  MAST-3B_X  MAST-3B_XX MAST-3B_XX_sp.</code></pre>
<p>One more making use of the tiebreakz argument:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">eTax3 &lt;-<span class="st"> </span><span class="kw">ensembleTax</span>(xx, 
                     <span class="dt">tablenames =</span> <span class="kw">names</span>(xx), 
                     <span class="dt">ranknames =</span> <span class="kw">c</span>(<span class="st">&quot;kingdom&quot;</span>, <span class="st">&quot;supergroup&quot;</span>, <span class="st">&quot;division&quot;</span>,<span class="st">&quot;class&quot;</span>,<span class="st">&quot;order&quot;</span>,<span class="st">&quot;family&quot;</span>,<span class="st">&quot;genus&quot;</span>,<span class="st">&quot;species&quot;</span>),
                     <span class="dt">tiebreakz =</span> <span class="kw">c</span>(<span class="st">&quot;bayes-pr2&quot;</span>), 
                     <span class="dt">count.na=</span><span class="ot">TRUE</span>, 
                     <span class="dt">assign.threshold =</span> <span class="dv">0</span>, 
                     <span class="dt">weights=</span><span class="kw">c</span>(<span class="dv">1</span>,<span class="dv">1</span>,<span class="dv">2</span>))</code></pre></div>
<pre><code>## Warning in if (!is.na(tiebreaker)) {: the condition has length &gt; 1 and only the
## first element will be used

## Warning in if (!is.na(tiebreaker)) {: the condition has length &gt; 1 and only the
## first element will be used

## Warning in if (!is.na(tiebreaker)) {: the condition has length &gt; 1 and only the
## first element will be used

## Warning in if (!is.na(tiebreaker)) {: the condition has length &gt; 1 and only the
## first element will be used

## Warning in if (!is.na(tiebreaker)) {: the condition has length &gt; 1 and only the
## first element will be used

## Warning in if (!is.na(tiebreaker)) {: the condition has length &gt; 1 and only the
## first element will be used

## Warning in if (!is.na(tiebreaker)) {: the condition has length &gt; 1 and only the
## first element will be used

## Warning in if (!is.na(tiebreaker)) {: the condition has length &gt; 1 and only the
## first element will be used

## Warning in if (!is.na(tiebreaker)) {: the condition has length &gt; 1 and only the
## first element will be used

## Warning in if (!is.na(tiebreaker)) {: the condition has length &gt; 1 and only the
## first element will be used

## Warning in if (!is.na(tiebreaker)) {: the condition has length &gt; 1 and only the
## first element will be used

## Warning in if (!is.na(tiebreaker)) {: the condition has length &gt; 1 and only the
## first element will be used

## Warning in if (!is.na(tiebreaker)) {: the condition has length &gt; 1 and only the
## first element will be used

## Warning in if (!is.na(tiebreaker)) {: the condition has length &gt; 1 and only the
## first element will be used</code></pre>
<pre><code>## no Frankenstein assignments detected</code></pre>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">head</span>(eTax3)</code></pre></div>
<pre><code>##       svN
## 1 sv14136
## 2 sv17278
## 3 sv20747
## 4  sv3579
## 5  sv4298
##                                                                                                                                  ASV
## 1     ACACCTACCAATTGAATGGTCCGGTGAGGACTCGGATTGTGGTTTAGCTCCTTCATTGGGGCCTGACTGCAAGAACTTGTCCGAACCTTATCATTTAGAGGAAGGTGAAGTTGTAACAAGGTTTCC
## 2    GCACCTACCGATTGAACCATACGGTGAGGTCCTCGGATTTCATGAATCGACCTTCACTGGGAGATTCGTGAGAGAAGTTGCCCAAACCTCGTGGTTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
## 3      GCACCCACCGATTGAAAAGCCCGGTGAAGAATCGGGATTGTAGCGTTGTCCTTCATTGGACATTGCCGTGAGAACCTTTCTGAACCTTGTTTTTTAGAGGAAGGTGAAGTCGTAACAAGGTCTCT
## 4 ACTCCTACCAATTGAATGATCCATGAAGTGTTTGGATTACATTGAAGATGGTGGTTTGCCGCTGTCGACGTCATGAGAAGTTCATTGAACCTTATCATTTAGAGGAAGGAGAAGTCATAACAAGGTTACC
## 5       GCACCTACCGATTGAATGGTCCGGTGAGATCTTCGGACTGCAGCGAAAGTCAGCAATGAGTTAGTCGCGGAAAGTTGATCAAACCTTACCATTTAGAGGAAGGTGAAGTCGTAACAAGGTTTCC
##     kingdom     supergroup     division           class             order
## 1 Eukaryota  Stramenopiles   Ochrophyta Bacillariophyta Bacillariophyta_X
## 2 Eukaryota  Stramenopiles   Ochrophyta          MOCH-2          MOCH-2_X
## 3 Eukaryota  Stramenopiles   Ochrophyta Bacillariophyta Bacillariophyta_X
## 4 Eukaryota Archaeplastida Streptophyta   Embryophyceae   Embryophyceae_X
## 5 Eukaryota  Stramenopiles     Opalozoa          MAST-3           MAST-3B
##                       family       genus        species
## 1 Polar-centric-Mediophyceae  Minidiscus Minidiscus_sp.
## 2                  MOCH-2_XX  MOCH-2_XXX MOCH-2_XXX_sp.
## 3 Polar-centric-Mediophyceae Chaetoceros           &lt;NA&gt;
## 4           Embryophyceae_XX        &lt;NA&gt;           &lt;NA&gt;
## 5                  MAST-3B_X  MAST-3B_XX MAST-3B_XX_sp.</code></pre>
</div>
</div>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
